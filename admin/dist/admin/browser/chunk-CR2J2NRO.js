import{a as L}from"./chunk-ZLF2JV5K.js";import{a as I,b as P,c as V,f as T,h as W,i as O,j as N,k as U,l as k,m as F,p as z}from"./chunk-WU5N6ZY2.js";import{$ as m,Ma as M,V as b,Ya as g,Za as p,_ as c,ab as S,bb as h,cb as f,db as o,eb as i,gb as y,jb as E,kb as d,qb as B,rb as r,sb as D,tb as v,ub as w,vb as A,wa as u,xb as _,yb as C,zb as x}from"./chunk-G2PPXY4B.js";var G=(n,t)=>t.id,j=(n,t)=>t.value;function Y(n,t){n&1&&(o(0,"div",1)(1,"span",2),r(2,"progress_activity"),i(),r(3," \u0417\u0430\u0433\u0440\u0443\u0437\u043A\u0430... "),i())}function q(n,t){n&1&&(o(0,"p",3),r(1," \u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0441\u043E\u0437\u0434\u0430\u0439\u0442\u0435 \u0431\u043E\u0442\u0430 \u043D\u0430 \u0441\u0442\u0440\u0430\u043D\u0438\u0446\u0435 "),o(2,"a",4),r(3,"\u0411\u043E\u0442\u044B"),i(),r(4,". "),i())}function H(n,t){if(n&1&&(o(0,"option",9),r(1),i()),n&2){let e=t.$implicit;f("value",e.id),u(),A("",e.firstName," ",e.lastName," ",e.countryFlag)}}function J(n,t){if(n&1&&(o(0,"option",9),r(1),i()),n&2){let e=t.$implicit;f("value",e.value),u(),w("",e.label," \u2014 ",e.desc)}}function K(n,t){if(n&1){let e=y();o(0,"div",5)(1,"label",6),r(2," \u0421\u0442\u0430\u0440\u0442 \u0437\u0430 N \u043C\u0438\u043D \u0434\u043E \u043A\u043E\u043D\u0446\u0430 "),o(3,"span",13),r(4,"\u041A\u043E\u0433\u0434\u0430 \u0431\u043E\u0442 \u043D\u0430\u0447\u0438\u043D\u0430\u0435\u0442 \u0442\u043E\u0440\u0433\u043E\u0432\u0430\u0442\u044C (\u043F\u0443\u0441\u0442\u043E = 0.5 \u043C\u0438\u043D)"),i()(),o(5,"input",25),E("ngModelChange",function(a){c(e);let l=d(3);return m(l.startMinutesBeforeEnd=a||null)}),i()()}if(n&2){let e=d(3);u(5),f("ngModel",e.startMinutesBeforeEnd)}}function Q(n,t){n&1&&(o(0,"span",20),r(1,"progress_activity"),i())}function X(n,t){n&1&&(o(0,"span",22)(1,"span",21),r(2,"check_circle"),i(),r(3," \u0421\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u043E "),i())}function Z(n,t){if(n&1&&(o(0,"span",23),r(1),i()),n&2){let e=d(3);u(),D(e.saveError)}}function $(n,t){if(n&1&&(o(0,"div",24),r(1," \u041A\u043E\u043D\u0444\u0438\u0433 ID: "),o(2,"code"),r(3),i(),o(4,"span",26),r(5),i()()),n&2){let e=d(3);u(3),v("",e.existingConfig.id.slice(0,8),"\u2026"),u(),B(e.existingConfig.isActive?"badge--green":"badge--gray"),u(),v(" ",e.existingConfig.isActive?"\u0410\u043A\u0442\u0438\u0432\u0435\u043D":"\u041E\u0442\u043A\u043B\u044E\u0447\u0451\u043D"," ")}}function ee(n,t){if(n&1){let e=y();o(0,"div",5)(1,"label",6),r(2,"\u0411\u043E\u0442-\u043F\u043E\u043B\u044C\u0437\u043E\u0432\u0430\u0442\u0435\u043B\u044C"),i(),o(3,"select",7),x("ngModelChange",function(a){c(e);let l=d(2);return C(l.selectedBotUserId,a)||(l.selectedBotUserId=a),m(a)}),o(4,"option",8),r(5,"\u2014 \u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u0431\u043E\u0442\u0430 \u2014"),i(),S(6,H,2,4,"option",9,G),i()(),o(8,"div",10)(9,"div",5)(10,"label",6),r(11,"\u041C\u0430\u043A\u0441. \u0446\u0435\u043D\u0430 (\u20AC)"),i(),o(12,"input",11),x("ngModelChange",function(a){c(e);let l=d(2);return C(l.maxPrice,a)||(l.maxPrice=a),m(a)}),i()(),o(13,"div",5)(14,"label",6),r(15,"\u041F\u0430\u0442\u0442\u0435\u0440\u043D \u043F\u043E\u0432\u0435\u0434\u0435\u043D\u0438\u044F"),i(),o(16,"select",7),x("ngModelChange",function(a){c(e);let l=d(2);return C(l.pattern,a)||(l.pattern=a),m(a)}),S(17,J,2,3,"option",9,j),i()()(),o(19,"div",10)(20,"div",5)(21,"label",6),r(22,"\u041C\u0438\u043D. \u0437\u0430\u0434\u0435\u0440\u0436\u043A\u0430 (\u0441\u0435\u043A)"),i(),o(23,"input",12),x("ngModelChange",function(a){c(e);let l=d(2);return C(l.minDelaySec,a)||(l.minDelaySec=a),m(a)}),i()(),o(24,"div",5)(25,"label",6),r(26,"\u041C\u0430\u043A\u0441. \u0437\u0430\u0434\u0435\u0440\u0436\u043A\u0430 (\u0441\u0435\u043A)"),i(),o(27,"input",12),x("ngModelChange",function(a){c(e);let l=d(2);return C(l.maxDelaySec,a)||(l.maxDelaySec=a),m(a)}),i()()(),o(28,"div",10)(29,"div",5)(30,"label",6),r(31," \u0418\u043D\u0442\u0435\u043D\u0441\u0438\u0432\u043D\u043E\u0441\u0442\u044C "),o(32,"span",13),r(33,"\u041C\u043D\u043E\u0436\u0438\u0442\u0435\u043B\u044C \u0448\u0430\u0433\u0430 \u0441\u0442\u0430\u0432\u043A\u0438: 1.0 = \u043E\u0434\u0438\u043D \u0448\u0430\u0433, 2.0 = \u0434\u0432\u0430 \u0448\u0430\u0433\u0430"),i()(),o(34,"input",14),x("ngModelChange",function(a){c(e);let l=d(2);return C(l.intensity,a)||(l.intensity=a),m(a)}),i()(),g(35,K,6,1,"div",5),i(),o(36,"div",15)(37,"label",16)(38,"input",17),x("ngModelChange",function(a){c(e);let l=d(2);return C(l.isActive,a)||(l.isActive=a),m(a)}),i(),r(39," \u0411\u043E\u0442 \u0430\u043A\u0442\u0438\u0432\u0435\u043D "),i()(),o(40,"div",18)(41,"button",19),E("click",function(){c(e);let a=d(2);return m(a.save())}),g(42,Q,2,0,"span",20),o(43,"span",21),r(44,"smart_toy"),i(),r(45),i(),g(46,X,4,0,"span",22),g(47,Z,2,1,"span",23),i(),g(48,$,6,4,"div",24)}if(n&2){let e=d(2);u(3),_("ngModel",e.selectedBotUserId),u(3),h(e.botUsers),u(6),_("ngModel",e.maxPrice),u(4),_("ngModel",e.pattern),u(),h(e.patterns),u(6),_("ngModel",e.minDelaySec),u(4),_("ngModel",e.maxDelaySec),u(7),_("ngModel",e.intensity),u(),p(e.isTimedPattern?35:-1),u(3),_("ngModel",e.isActive),u(3),f("disabled",e.saving||!e.selectedBotUserId||!e.maxPrice),u(),p(e.saving?42:-1),u(3),v(" ",e.existingConfig?"\u041E\u0431\u043D\u043E\u0432\u0438\u0442\u044C \u0431\u043E\u0442\u0430":"\u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0431\u043E\u0442\u0430"," "),u(),p(e.saved?46:-1),u(),p(e.saveError?47:-1),u(),p(e.existingConfig?48:-1)}}function te(n,t){if(n&1&&g(0,q,5,0,"p",3)(1,ee,49,14),n&2){let e=d();p(e.botUsers.length===0?0:1)}}var R=class n{lotId="";botService=b(L);botUsers=[];existingConfig=null;loading=!0;saving=!1;saved=!1;saveError="";selectedBotUserId="";maxPrice=0;pattern="AGGRESSIVE";isActive=!0;minDelaySec=2;maxDelaySec=10;intensity=1;startMinutesBeforeEnd=null;patterns=[{value:"AGGRESSIVE",label:"\u0410\u0433\u0440\u0435\u0441\u0441\u0438\u0432\u043D\u044B\u0439",desc:"\u041F\u0435\u0440\u0435\u0431\u0438\u0432\u0430\u0435\u0442 \u0447\u0435\u0440\u0435\u0437 2\u20135 \u0441\u0435\u043A"},{value:"STEADY",label:"\u0420\u0435\u0433\u0443\u043B\u044F\u0440\u043D\u044B\u0439",desc:"\u0421\u0442\u0430\u0432\u0438\u0442 \u043A\u0430\u0436\u0434\u044B\u0435 N \u0441\u0435\u043A\u0443\u043D\u0434"},{value:"SNIPER",label:"\u0421\u043D\u0430\u0439\u043F\u0435\u0440",desc:"\u0410\u043A\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044F \u0437\u0430 N \u043C\u0438\u043D \u0434\u043E \u043A\u043E\u043D\u0446\u0430"},{value:"RANDOM",label:"\u0421\u043B\u0443\u0447\u0430\u0439\u043D\u044B\u0439",desc:"\u0421\u043B\u0443\u0447\u0430\u0439\u043D\u0430\u044F \u0437\u0430\u0434\u0435\u0440\u0436\u043A\u0430, \u0430\u043A\u0442\u0438\u0432\u0438\u0440\u0443\u0435\u0442\u0441\u044F \u0437\u0430 N \u043C\u0438\u043D \u0434\u043E \u043A\u043E\u043D\u0446\u0430"}];get isTimedPattern(){return this.pattern==="SNIPER"||this.pattern==="RANDOM"}ngOnInit(){this.load()}load(){this.loading=!0,this.botService.getBotUsers().subscribe({next:t=>{this.botUsers=t,this.botService.getConfigs(this.lotId).subscribe({next:e=>{this.existingConfig=e[0]??null,this.existingConfig&&this.fillForm(this.existingConfig),this.loading=!1},error:()=>this.loading=!1})},error:()=>this.loading=!1})}fillForm(t){this.selectedBotUserId=t.botUserId,this.maxPrice=t.maxPrice,this.pattern=t.pattern,this.isActive=t.isActive,this.minDelaySec=t.minDelaySec,this.maxDelaySec=t.maxDelaySec,this.intensity=t.intensity??1,this.startMinutesBeforeEnd=t.startMinutesBeforeEnd??null}save(){if(!this.selectedBotUserId||!this.maxPrice)return;this.saving=!0,this.saved=!1,this.saveError="";let t={lotId:this.lotId,botUserId:this.selectedBotUserId,maxPrice:this.maxPrice,pattern:this.pattern,isActive:this.isActive,minDelaySec:this.minDelaySec,maxDelaySec:this.maxDelaySec,intensity:this.intensity,startMinutesBeforeEnd:this.startMinutesBeforeEnd};(this.existingConfig?this.botService.updateConfig(this.existingConfig.id,t):this.botService.createConfig(t)).subscribe({next:s=>{this.existingConfig=s,this.saving=!1,this.saved=!0,setTimeout(()=>this.saved=!1,3e3)},error:s=>{this.saveError=s?.error?.message??"\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F",this.saving=!1}})}toggleActive(){this.existingConfig&&this.botService.updateConfig(this.existingConfig.id,{isActive:!this.existingConfig.isActive}).subscribe({next:t=>{this.existingConfig=t,this.isActive=t.isActive}})}static \u0275fac=function(e){return new(e||n)};static \u0275cmp=M({type:n,selectors:[["app-bot-settings"]],inputs:{lotId:"lotId"},decls:3,vars:2,consts:[[1,"bot-settings"],[2,"padding","12px 0","color","var(--text-secondary)","font-size","var(--fs-sm)"],[1,"material-symbols-rounded","spin",2,"font-size","16px"],[1,"text-muted",2,"font-size","var(--fs-sm)"],["href","/bots",1,"link"],[1,"form-group"],[1,"form-label"],[1,"form-control",3,"ngModelChange","ngModel"],["value",""],[3,"value"],[1,"form-row"],["type","number","min","0",1,"form-control",3,"ngModelChange","ngModel"],["type","number","min","1","max","600",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-hint"],["type","number","min","0.1","max","10","step","0.1",1,"form-control",3,"ngModelChange","ngModel"],[1,"form-group-inline"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[1,"form-actions"],[1,"btn","btn--secondary","btn--sm",3,"click","disabled"],[1,"material-symbols-rounded","spin"],[1,"material-symbols-rounded"],[1,"save-success"],[1,"save-error"],[1,"config-status"],["type","number","min","1","max","60","placeholder","0.5",1,"form-control",3,"ngModelChange","ngModel"],[1,"badge"]],template:function(e,s){e&1&&(o(0,"div",0),g(1,Y,4,0,"div",1),g(2,te,2,1),i()),e&2&&(u(),p(s.loading?1:-1),u(),p(s.loading?-1:2))},dependencies:[z,N,U,P,W,I,O,V,F,k,T],styles:[".bot-settings[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;padding:16px;border:1px solid var(--border);border-radius:var(--radius);background:var(--surface-hover)}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.form-group-inline[_ngcontent-%COMP%]{display:flex;align-items:center}.form-label[_ngcontent-%COMP%]{font-size:var(--fs-sm);color:var(--text-secondary);font-weight:500}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:var(--fs-sm);cursor:pointer}.form-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:10px}.save-success[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;color:var(--green);font-size:var(--fs-sm)}.save-error[_ngcontent-%COMP%]{color:var(--red);font-size:var(--fs-sm)}.config-status[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:var(--fs-xs);color:var(--text-secondary)}.link[_ngcontent-%COMP%]{color:var(--accent);text-decoration:none}.link[_ngcontent-%COMP%]:hover{text-decoration:underline}"]})};export{R as a};
