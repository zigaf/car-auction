import{a as G}from"./chunk-GXIRCPNU.js";import{f as B}from"./chunk-ELGPTX6G.js";import{c as R,f as V,i as L,j as A,k as U,p as $}from"./chunk-3D23ORGU.js";import{g as F,i as N}from"./chunk-XJI6OOWZ.js";import{$ as f,$a as _,Bb as I,Cb as D,La as y,V as h,Wa as g,Xa as p,Ya as v,Za as C,_ as m,_a as P,ab as n,bb as i,db as O,gb as u,hb as l,mb as S,nb as o,ob as x,pb as k,qb as b,tb as T,ub as E,vb as w,wa as r,xb as z,zb as M}from"./chunk-AYG5IDLV.js";var W=e=>["/users",e],X=(e,a)=>a.id;function q(e,a){if(e&1&&(n(0,"option",7),o(1),i()),e&2){let t=a.$implicit,s=l();_("value",t),r(),x(s.statusLabels[t])}}function H(e,a){if(e&1&&(n(0,"div",8)(1,"span",10),o(2,"error"),i(),o(3),i()),e&2){let t=l();r(3),k("",t.error," ")}}function J(e,a){e&1&&(n(0,"div",9)(1,"span",11),o(2,"progress_activity"),i()())}function K(e,a){if(e&1&&(n(0,"div",17),o(1),M(2,"slice"),i()),e&2){let t=l().$implicit;r(),b("",D(2,2,t.description,0,60),"",t.description.length>60?"\u2026":"")}}function Q(e,a){if(e&1&&(n(0,"a",18),o(1),i()),e&2){let t=l().$implicit;_("routerLink",z(3,W,t.targetUserId)),r(),b(" ",t.targetUser.firstName," ",t.targetUser.lastName," ")}}function Y(e,a){e&1&&(n(0,"span",19),o(1,"\u2014"),i())}function Z(e,a){if(e&1&&o(0),e&2){let t=l().$implicit;b(" ",t.assignedTo.firstName," ",t.assignedTo.lastName," ")}}function tt(e,a){e&1&&o(0," \u2014 ")}function et(e,a){if(e&1){let t=O();n(0,"tr")(1,"td")(2,"div",16),o(3),i(),g(4,K,3,6,"div",17),i(),n(5,"td"),g(6,Q,2,5,"a",18)(7,Y,2,0,"span",19),i(),n(8,"td",19),g(9,Z,1,2)(10,tt,1,0),i(),n(11,"td")(12,"button",20),u("click",function(){let c=m(t).$implicit,d=l(2);return f(d.cycleStatus(c))}),o(13),i()(),n(14,"td",19),o(15),M(16,"date"),i(),n(17,"td")(18,"button",21),u("click",function(){let c=m(t).$implicit,d=l(2);return f(d.deleteTask(c.id))}),n(19,"span",10),o(20,"delete"),i()()()()}if(e&2){let t=a.$implicit,s=l(2);r(3),x(t.title),r(),p(t.description?4:-1),r(2),p(t.targetUser?6:7),r(3),p(t.assignedTo?9:10),r(3),S(s.statusClass[t.status]),r(),k(" ",s.statusLabels[t.status]," "),r(2),x(t.dueDate?I(16,8,t.dueDate,"dd.MM.yy"):"\u2014")}}function nt(e,a){e&1&&(n(0,"div",14)(1,"span",10),o(2,"checklist"),i(),n(3,"p"),o(4,"\u0417\u0430\u0434\u0430\u0447\u0438 \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u044B"),i()())}function it(e,a){if(e&1){let t=O();n(0,"div",15)(1,"button",22),u("click",function(){m(t);let c=l(2);return f(c.prevPage())}),n(2,"span",10),o(3,"chevron_left"),i()(),n(4,"span",23),o(5),i(),n(6,"button",22),u("click",function(){m(t);let c=l(2);return f(c.nextPage())}),n(7,"span",10),o(8,"chevron_right"),i()()()}if(e&2){let t=l(2);r(),_("disabled",t.page===1),r(4),b("",t.page," / ",t.totalPages),r(),_("disabled",t.page===t.totalPages)}}function ot(e,a){if(e&1&&(n(0,"div",12)(1,"table",13)(2,"thead")(3,"tr")(4,"th"),o(5,"\u0417\u0430\u0434\u0430\u0447\u0430"),i(),n(6,"th"),o(7,"\u041A\u043B\u0438\u0435\u043D\u0442"),i(),n(8,"th"),o(9,"\u041C\u0435\u043D\u0435\u0434\u0436\u0435\u0440"),i(),n(10,"th"),o(11,"\u0421\u0442\u0430\u0442\u0443\u0441"),i(),n(12,"th"),o(13,"\u0421\u0440\u043E\u043A"),i(),n(14,"th"),o(15,"\u0414\u0435\u0439\u0441\u0442\u0432\u0438\u044F"),i()()(),n(16,"tbody"),C(17,et,21,11,"tr",null,X),i()()(),g(19,nt,5,0,"div",14),g(20,it,9,4,"div",15)),e&2){let t=l();r(17),P(t.tasks),r(2),p(t.tasks.length===0?19:-1),r(),p(t.totalPages>1?20:-1)}}var at={TODO:"\u0421\u0434\u0435\u043B\u0430\u0442\u044C",IN_PROGRESS:"\u0412 \u0440\u0430\u0431\u043E\u0442\u0435",DONE:"\u0413\u043E\u0442\u043E\u0432\u043E"},rt={TODO:"badge--gray",IN_PROGRESS:"badge--amber",DONE:"badge--green"},st={TODO:"IN_PROGRESS",IN_PROGRESS:"DONE",DONE:"TODO"},j=class e{taskService=h(G);tasks=[];total=0;page=1;limit=20;loading=!0;error="";filterStatus="";statusLabels=at;statusClass=rt;statuses=["TODO","IN_PROGRESS","DONE"];ngOnInit(){this.load()}load(){this.loading=!0,this.error="",this.taskService.getTasks({status:this.filterStatus||void 0,page:this.page,limit:this.limit}).subscribe({next:a=>{this.tasks=a.data,this.total=a.total,this.loading=!1},error:()=>{this.error="\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0437\u0430\u0434\u0430\u0447\u0438",this.loading=!1}})}onFilterChange(){this.page=1,this.load()}cycleStatus(a){let t=st[a.status];this.taskService.updateTask(a.id,{status:t}).subscribe({next:s=>{let c=this.tasks.findIndex(d=>d.id===a.id);c!==-1&&(this.tasks[c]=s)}})}deleteTask(a){this.taskService.deleteTask(a).subscribe({next:()=>{this.tasks=this.tasks.filter(t=>t.id!==a),this.total--}})}prevPage(){this.page>1&&(this.page--,this.load())}nextPage(){this.page*this.limit<this.total&&(this.page++,this.load())}get totalPages(){return Math.ceil(this.total/this.limit)}static \u0275fac=function(t){return new(t||e)};static \u0275cmp=y({type:e,selectors:[["app-tasks"]],decls:15,vars:5,consts:[[1,"page"],[1,"page-header"],[1,"page-title"],[1,"page-count"],[1,"filters"],[1,"form-control","filters__select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value"],[1,"state-error"],[1,"state-loading"],[1,"material-symbols-rounded"],[1,"material-symbols-rounded","spin"],[1,"table-wrap"],[1,"data-table"],[1,"empty-state"],[1,"pagination"],[1,"task-title"],[1,"text-muted",2,"font-size","var(--fs-xs)"],[1,"link",3,"routerLink"],[1,"text-muted"],["title","\u041D\u0430\u0436\u043C\u0438\u0442\u0435, \u0447\u0442\u043E\u0431\u044B \u0438\u0437\u043C\u0435\u043D\u0438\u0442\u044C",1,"badge","badge--clickable",3,"click"],["title","\u0423\u0434\u0430\u043B\u0438\u0442\u044C",1,"icon-btn","icon-btn--danger",3,"click"],[1,"btn","btn--secondary","btn--sm",3,"click","disabled"],[1,"pagination__info"]],template:function(t,s){t&1&&(n(0,"div",0)(1,"div",1)(2,"h1",2),o(3,"\u0417\u0430\u0434\u0430\u0447\u0438"),i(),n(4,"span",3),o(5),i()(),n(6,"div",4)(7,"select",5),w("ngModelChange",function(d){return E(s.filterStatus,d)||(s.filterStatus=d),d}),u("change",function(){return s.onFilterChange()}),n(8,"option",6),o(9,"\u0412\u0441\u0435 \u0441\u0442\u0430\u0442\u0443\u0441\u044B"),i(),C(10,q,2,2,"option",7,v),i()(),g(12,H,4,1,"div",8),g(13,J,3,0,"div",9),g(14,ot,21,2),i()),t&2&&(r(5),x(s.total),r(2),T("ngModel",s.filterStatus),r(3),P(s.statuses),r(2),p(s.error?12:-1),r(),p(s.loading?13:-1),r(),p(!s.loading&&!s.error?14:-1))},dependencies:[$,A,U,L,R,V,B,F,N],styles:[".page[_ngcontent-%COMP%]{padding:32px;max-width:1200px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:32px}.page-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#111827}.page-count[_ngcontent-%COMP%]{font-size:.8125rem;color:#6b7280;background:#f3f4f6;padding:2px 10px;border-radius:20px}.filters[_ngcontent-%COMP%]{display:flex;gap:8px;margin-bottom:24px;flex-wrap:wrap}.filters__search[_ngcontent-%COMP%]{flex:1;min-width:200px}.filters__select[_ngcontent-%COMP%]{min-width:160px;width:auto}.form-control[_ngcontent-%COMP%]{width:100%;padding:12px 16px;background:#f8f9fb;color:#111827;font-family:Manrope,-apple-system,BlinkMacSystemFont,sans-serif;font-size:.875rem;border:1px solid #E5E7EB;border-radius:8px;transition:border-color .15s ease,box-shadow .15s ease;outline:none}.form-control[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.form-control[_ngcontent-%COMP%]:focus{border-color:#4f46e5;box-shadow:0 0 0 3px #4f46e514}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:8px 12px;border:none;border-radius:8px;font-family:Manrope,-apple-system,BlinkMacSystemFont,sans-serif;font-size:.8125rem;font-weight:600;cursor:pointer;transition:all .15s ease}.btn--primary[_ngcontent-%COMP%]{background:#4f46e5;color:#fff}.btn--primary[_ngcontent-%COMP%]:hover{background:#4338ca;box-shadow:0 4px 14px #4f46e540}.btn--primary[_ngcontent-%COMP%]:active{background:#3730a3}.btn--secondary[_ngcontent-%COMP%]{background:transparent;color:#111827;border:1px solid #E5E7EB}.btn--secondary[_ngcontent-%COMP%]:hover{border-color:#d1d5db;background:#f3f4f6}.btn--danger[_ngcontent-%COMP%]{background:#ef444414;color:#ef4444;border:1px solid rgba(239,68,68,.2)}.btn--danger[_ngcontent-%COMP%]:hover{background:#ef444426}.btn--ghost[_ngcontent-%COMP%]{background:none;color:#6b7280}.btn--ghost[_ngcontent-%COMP%]:hover{color:#111827;background:#f3f4f6}.btn--sm[_ngcontent-%COMP%]{padding:4px 10px;font-size:.6875rem}.btn--icon[_ngcontent-%COMP%]{padding:4px;background:none;color:#6b7280;border:none;border-radius:4px;display:flex;align-items:center}.btn--icon[_ngcontent-%COMP%]:hover{color:#111827;background:#f3f4f6}.btn--icon[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:18px}.btn[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.btn[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:16px;flex-shrink:0}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:2px 8px;border-radius:20px;font-size:.6875rem;font-weight:600}.badge--green[_ngcontent-%COMP%]{background:#22c55e1a;color:#1a9a49}.badge--red[_ngcontent-%COMP%]{background:#ef44441a;color:#ec1e1e}.badge--amber[_ngcontent-%COMP%]{background:#f59e0b1f;color:#c57f08}.badge--blue[_ngcontent-%COMP%]{background:#3b82f61a;color:#1469f4}.badge--gray[_ngcontent-%COMP%]{background:#f3f4f6;color:#6b7280}.table-wrap[_ngcontent-%COMP%]{background:#fff;border:1px solid #E5E7EB;border-radius:16px;overflow:hidden;box-shadow:0 1px 2px #0000000d}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:8px 16px;text-align:left;font-size:.6875rem;font-weight:600;color:#9ca3af;text-transform:uppercase;letter-spacing:.5px;background:#f8f9fb;border-bottom:1px solid #E5E7EB;white-space:nowrap}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;font-size:.8125rem;color:#111827;border-bottom:1px solid #F3F4F6;vertical-align:middle}.data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#4f46e50a}.text-muted[_ngcontent-%COMP%]{color:#6b7280}.state-loading[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:48px;color:#9ca3af}.state-loading[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:28px}.state-error[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#ef44440f;border:1px solid rgba(239,68,68,.2);border-radius:8px;color:#ef4444;margin-bottom:24px;font-size:.8125rem}.state-error[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:18px;flex-shrink:0}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:48px;color:#9ca3af}.empty-state[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:40px;display:block;margin-bottom:12px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem}.pagination[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;margin-top:24px}.pagination__info[_ngcontent-%COMP%]{font-size:.8125rem;color:#6b7280;min-width:60px;text-align:center}.tabs[_ngcontent-%COMP%]{display:flex;gap:2px;margin-bottom:24px;background:#f3f4f6;padding:3px;border-radius:8px;width:fit-content}.tab-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:6px 12px;border:none;border-radius:6px;background:transparent;color:#6b7280;font-family:Manrope,-apple-system,BlinkMacSystemFont,sans-serif;font-size:.8125rem;font-weight:500;cursor:pointer;transition:all .15s ease}.tab-btn[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:16px}.tab-btn[_ngcontent-%COMP%]:hover{background:#fff;color:#111827}.tab-btn--active[_ngcontent-%COMP%]{background:#fff;color:#4f46e5;font-weight:600;box-shadow:0 1px 2px #0000000d}.card[_ngcontent-%COMP%]{background:#fff;border:1px solid #E5E7EB;border-radius:12px;padding:24px;display:flex;flex-direction:column;gap:12px;margin-bottom:24px}.card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:.875rem;font-weight:600;color:#111827;margin:0}.card-title[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:18px;color:#6b7280}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px}.form-label[_ngcontent-%COMP%]{font-size:.8125rem;font-weight:500;color:#6b7280}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px}.form-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding-top:4px}.save-success[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;color:#22c55e;font-size:.8125rem;font-weight:500}.save-success[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:16px}.save-error[_ngcontent-%COMP%]{color:#ef4444;font-size:.8125rem}.icon-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:30px;height:30px;border:none;background:none;cursor:pointer;border-radius:4px;color:#6b7280;transition:background .15s ease,color .15s ease;flex-shrink:0}.icon-btn[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:18px}.icon-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#111827}.icon-btn--danger[_ngcontent-%COMP%]:hover{background:#ef444414;color:#ef4444}.actions-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;white-space:nowrap}.link[_ngcontent-%COMP%]{color:#4f46e5;text-decoration:none;font-weight:500}.link[_ngcontent-%COMP%]:hover{color:#4338ca;text-decoration:underline}.section[_ngcontent-%COMP%]{margin-bottom:32px}.section-title[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#111827;margin:0 0 12px}.fw-semibold[_ngcontent-%COMP%]{font-weight:600}.status-select[_ngcontent-%COMP%]{background:#f8f9fb;border:1px solid #E5E7EB;border-radius:4px;color:#111827;font-size:.6875rem;font-family:Manrope,-apple-system,BlinkMacSystemFont,sans-serif;padding:3px 8px;cursor:pointer;outline:none;transition:border-color .15s ease}.status-select[_ngcontent-%COMP%]:hover{border-color:#d1d5db}.status-select[_ngcontent-%COMP%]:focus{border-color:#4f46e5;box-shadow:0 0 0 2px #4f46e514}.task-title[_ngcontent-%COMP%]{font-weight:500;font-size:.8125rem}.badge--clickable[_ngcontent-%COMP%]{cursor:pointer;border:none}.badge--clickable[_ngcontent-%COMP%]:hover{opacity:.8}"]})};export{j as TasksPage};
