import{c as j,f as L,i as R,j as $,k as U,p as W}from"./chunk-WU5N6ZY2.js";import{a as V}from"./chunk-XXMQUF42.js";import{i as D,j as N}from"./chunk-H2AGEXJJ.js";import{$ as x,$a as M,Db as y,Eb as F,Fb as A,Ma as E,Q as w,U as S,V as k,Ya as p,Za as g,_ as b,ab as _,bb as C,cb as m,db as t,eb as n,gb as h,jb as f,kb as s,rb as r,sb as u,tb as O,ub as v,vb as I,wa as a,xb as z,yb as B,zb as T}from"./chunk-G2PPXY4B.js";var P=class o{constructor(i){this.api=i}getOrders(i={}){return this.api.get("/orders",{page:i.page??1,limit:i.limit??20,status:i.status})}getOrder(i){return this.api.get(`/orders/${i}`)}updateOrderStatus(i,e){return this.api.patch(`/orders/${i}/status`,{status:e})}static \u0275fac=function(e){return new(e||o)(S(V))};static \u0275prov=w({token:o,factory:o.\u0275fac,providedIn:"root"})};var K=(o,i)=>i.id;function Q(o,i){if(o&1&&(t(0,"option",7),r(1),n()),o&2){let e=i.$implicit,l=s();m("value",e),a(),u(l.statusLabels[e])}}function X(o,i){if(o&1&&(t(0,"div",8)(1,"span",10),r(2,"error"),n(),r(3),n()),o&2){let e=s();a(3),O(" ",e.error," ")}}function Y(o,i){o&1&&(t(0,"div",9)(1,"span",11),r(2,"progress_activity"),n()())}function Z(o,i){if(o&1&&(t(0,"option",22),r(1),n()),o&2){let e=i.$implicit,l=s().$implicit,d=s(2);m("value",e)("selected",l.status===e),a(),u(d.statusLabels[e])}}function ee(o,i){if(o&1){let e=h();t(0,"tr")(1,"td",16),r(2),n(),t(3,"td")(4,"div",17),r(5),n()(),t(6,"td")(7,"div",18),r(8),n(),t(9,"div",19),r(10),n()(),t(11,"td",20),r(12),y(13,"number"),n(),t(14,"td")(15,"select",21),f("change",function(d){let c=b(e).$implicit,G=s(2);return x(G.updateStatus(c,d.target.value))}),_(16,Z,2,3,"option",22,M),n()(),t(18,"td",23),r(19),y(20,"date"),n()()}if(o&2){let e=i.$implicit,l=s(2);a(2),O("",e.id.slice(0,8),"\u2026"),a(3),I("",e.lot==null?null:e.lot.brand," ",e.lot==null?null:e.lot.model," ",e.lot==null?null:e.lot.year),a(3),v("",e.user==null?null:e.user.firstName," ",e.user==null?null:e.user.lastName),a(2),u(e.user==null?null:e.user.email),a(2),O("",F(13,10,e.total)," EUR"),a(3),m("value",e.status),a(),C(l.statuses),a(3),u(A(20,12,e.createdAt,"dd.MM.yy HH:mm"))}}function te(o,i){o&1&&(t(0,"div",14)(1,"span",10),r(2,"receipt_long"),n(),t(3,"p"),r(4,"\u0417\u0430\u043A\u0430\u0437\u044B \u043D\u0435 \u043D\u0430\u0439\u0434\u0435\u043D\u044B"),n()())}function ne(o,i){if(o&1){let e=h();t(0,"div",15)(1,"button",24),f("click",function(){b(e);let d=s(2);return x(d.prevPage())}),t(2,"span",10),r(3,"chevron_left"),n()(),t(4,"span",25),r(5),n(),t(6,"button",24),f("click",function(){b(e);let d=s(2);return x(d.nextPage())}),t(7,"span",10),r(8,"chevron_right"),n()()()}if(o&2){let e=s(2);a(),m("disabled",e.page===1),a(4),v("",e.page," / ",e.totalPages),a(),m("disabled",e.page===e.totalPages)}}function oe(o,i){if(o&1&&(t(0,"div",12)(1,"table",13)(2,"thead")(3,"tr")(4,"th"),r(5,"ID"),n(),t(6,"th"),r(7,"\u041B\u043E\u0442"),n(),t(8,"th"),r(9,"\u041F\u043E\u043A\u0443\u043F\u0430\u0442\u0435\u043B\u044C"),n(),t(10,"th"),r(11,"\u0421\u0443\u043C\u043C\u0430"),n(),t(12,"th"),r(13,"\u0421\u0442\u0430\u0442\u0443\u0441"),n(),t(14,"th"),r(15,"\u0414\u0430\u0442\u0430"),n()()(),t(16,"tbody"),_(17,ee,21,15,"tr",null,K),n()()(),p(19,te,5,0,"div",14),p(20,ne,9,4,"div",15)),o&2){let e=s();a(17),C(e.orders),a(2),g(e.orders.length===0?19:-1),a(),g(e.totalPages>1?20:-1)}}var H={pending:"\u041E\u0436\u0438\u0434\u0430\u0435\u0442 \u043F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0435\u043D\u0438\u044F",approved:"\u041F\u043E\u0434\u0442\u0432\u0435\u0440\u0436\u0434\u0451\u043D",paid:"\u041E\u043F\u043B\u0430\u0447\u0435\u043D",delivered_svh:"\u0414\u043E\u0441\u0442\u0430\u0432\u043B\u0435\u043D \u043D\u0430 \u0421\u0412\u0425",customs:"\u041D\u0430 \u0440\u0430\u0441\u0442\u0430\u043C\u043E\u0436\u043A\u0435",cleared:"\u0420\u0430\u0441\u0442\u0430\u043C\u043E\u0436\u0435\u043D",delivering:"\u0412 \u0434\u043E\u0441\u0442\u0430\u0432\u043A\u0435",completed:"\u0417\u0430\u0432\u0435\u0440\u0448\u0451\u043D"},ie={pending:"badge--amber",approved:"badge--blue",paid:"badge--blue",delivered_svh:"badge--orange",customs:"badge--orange",cleared:"badge--orange",delivering:"badge--purple",completed:"badge--green"},J=class o{orderService=k(P);orders=[];loading=!0;error="";total=0;page=1;limit=20;filterStatus="";statuses=Object.keys(H);statusLabels=H;statusBadge=ie;ngOnInit(){this.load()}load(){this.loading=!0,this.error="",this.orderService.getOrders({page:this.page,limit:this.limit,status:this.filterStatus||void 0}).subscribe({next:i=>{this.orders=i.data,this.total=i.total,this.loading=!1},error:()=>{this.error="\u041D\u0435 \u0443\u0434\u0430\u043B\u043E\u0441\u044C \u0437\u0430\u0433\u0440\u0443\u0437\u0438\u0442\u044C \u0437\u0430\u043A\u0430\u0437\u044B",this.loading=!1}})}onFilterChange(){this.page=1,this.load()}prevPage(){this.page>1&&(this.page--,this.load())}nextPage(){this.page*this.limit<this.total&&(this.page++,this.load())}get totalPages(){return Math.ceil(this.total/this.limit)}updateStatus(i,e){this.orderService.updateOrderStatus(i.id,e).subscribe({next:l=>{let d=this.orders.findIndex(c=>c.id===l.id);d!==-1&&(this.orders[d]=l)}})}static \u0275fac=function(e){return new(e||o)};static \u0275cmp=E({type:o,selectors:[["app-orders"]],decls:15,vars:5,consts:[[1,"page"],[1,"page-header"],[1,"page-title"],[1,"page-count"],[1,"filters"],[1,"form-control","filters__select",3,"ngModelChange","change","ngModel"],["value",""],[3,"value"],[1,"state-error"],[1,"state-loading"],[1,"material-symbols-rounded"],[1,"material-symbols-rounded","spin"],[1,"table-wrap"],[1,"data-table"],[1,"empty-state"],[1,"pagination"],[1,"mono","text-muted"],[1,"order-lot"],[1,"buyer-name"],[1,"buyer-email"],[1,"order-amount"],[1,"status-select",3,"change","value"],[3,"value","selected"],[1,"text-muted"],[1,"btn","btn--secondary","btn--sm",3,"click","disabled"],[1,"pagination__info"]],template:function(e,l){e&1&&(t(0,"div",0)(1,"div",1)(2,"h1",2),r(3,"\u0417\u0430\u043A\u0430\u0437\u044B"),n(),t(4,"span",3),r(5),n()(),t(6,"div",4)(7,"select",5),T("ngModelChange",function(c){return B(l.filterStatus,c)||(l.filterStatus=c),c}),f("change",function(){return l.onFilterChange()}),t(8,"option",6),r(9,"\u0412\u0441\u0435 \u0441\u0442\u0430\u0442\u0443\u0441\u044B"),n(),_(10,Q,2,2,"option",7,M),n()(),p(12,X,4,1,"div",8),p(13,Y,3,0,"div",9),p(14,oe,21,2),n()),e&2&&(a(5),u(l.total),a(2),z("ngModel",l.filterStatus),a(3),C(l.statuses),a(2),g(l.error?12:-1),a(),g(l.loading?13:-1),a(),g(!l.loading&&!l.error?14:-1))},dependencies:[W,$,U,R,j,L,N,D],styles:[".page[_ngcontent-%COMP%]{padding:32px;max-width:1200px;margin:0 auto}.page-header[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-bottom:32px}.page-title[_ngcontent-%COMP%]{font-size:1.5rem;font-weight:700;color:#111827}.page-count[_ngcontent-%COMP%]{font-size:.8125rem;color:#6b7280;background:#f3f4f6;padding:2px 10px;border-radius:20px}.filters[_ngcontent-%COMP%]{display:flex;gap:8px;margin-bottom:24px;flex-wrap:wrap}.filters__search[_ngcontent-%COMP%]{flex:1;min-width:200px}.filters__select[_ngcontent-%COMP%]{min-width:160px;width:auto}.form-control[_ngcontent-%COMP%]{width:100%;padding:12px 16px;background:#f8f9fb;color:#111827;font-family:Manrope,-apple-system,BlinkMacSystemFont,sans-serif;font-size:.875rem;border:1px solid #E5E7EB;border-radius:8px;transition:border-color .15s ease,box-shadow .15s ease;outline:none}.form-control[_ngcontent-%COMP%]::placeholder{color:#9ca3af}.form-control[_ngcontent-%COMP%]:focus{border-color:#4f46e5;box-shadow:0 0 0 3px #4f46e514}.btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:8px 12px;border:none;border-radius:8px;font-family:Manrope,-apple-system,BlinkMacSystemFont,sans-serif;font-size:.8125rem;font-weight:600;cursor:pointer;transition:all .15s ease}.btn--primary[_ngcontent-%COMP%]{background:#4f46e5;color:#fff}.btn--primary[_ngcontent-%COMP%]:hover{background:#4338ca;box-shadow:0 4px 14px #4f46e540}.btn--primary[_ngcontent-%COMP%]:active{background:#3730a3}.btn--secondary[_ngcontent-%COMP%]{background:transparent;color:#111827;border:1px solid #E5E7EB}.btn--secondary[_ngcontent-%COMP%]:hover{border-color:#d1d5db;background:#f3f4f6}.btn--danger[_ngcontent-%COMP%]{background:#ef444414;color:#ef4444;border:1px solid rgba(239,68,68,.2)}.btn--danger[_ngcontent-%COMP%]:hover{background:#ef444426}.btn--ghost[_ngcontent-%COMP%]{background:none;color:#6b7280}.btn--ghost[_ngcontent-%COMP%]:hover{color:#111827;background:#f3f4f6}.btn--sm[_ngcontent-%COMP%]{padding:4px 10px;font-size:.6875rem}.btn--icon[_ngcontent-%COMP%]{padding:4px;background:none;color:#6b7280;border:none;border-radius:4px;display:flex;align-items:center}.btn--icon[_ngcontent-%COMP%]:hover{color:#111827;background:#f3f4f6}.btn--icon[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:18px}.btn[_ngcontent-%COMP%]:disabled{opacity:.4;cursor:not-allowed}.btn[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:16px;flex-shrink:0}.badge[_ngcontent-%COMP%]{display:inline-flex;align-items:center;padding:2px 8px;border-radius:20px;font-size:.6875rem;font-weight:600}.badge--green[_ngcontent-%COMP%]{background:#22c55e1a;color:#1a9a49}.badge--red[_ngcontent-%COMP%]{background:#ef44441a;color:#ec1e1e}.badge--amber[_ngcontent-%COMP%]{background:#f59e0b1f;color:#c57f08}.badge--blue[_ngcontent-%COMP%]{background:#3b82f61a;color:#1469f4}.badge--gray[_ngcontent-%COMP%]{background:#f3f4f6;color:#6b7280}.table-wrap[_ngcontent-%COMP%]{background:#fff;border:1px solid #E5E7EB;border-radius:16px;overflow:hidden;box-shadow:0 1px 2px #0000000d}.data-table[_ngcontent-%COMP%]{width:100%;border-collapse:collapse}.data-table[_ngcontent-%COMP%]   th[_ngcontent-%COMP%]{padding:8px 16px;text-align:left;font-size:.6875rem;font-weight:600;color:#9ca3af;text-transform:uppercase;letter-spacing:.5px;background:#f8f9fb;border-bottom:1px solid #E5E7EB;white-space:nowrap}.data-table[_ngcontent-%COMP%]   td[_ngcontent-%COMP%]{padding:12px 16px;font-size:.8125rem;color:#111827;border-bottom:1px solid #F3F4F6;vertical-align:middle}.data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:last-child   td[_ngcontent-%COMP%]{border-bottom:none}.data-table[_ngcontent-%COMP%]   tr[_ngcontent-%COMP%]:hover   td[_ngcontent-%COMP%]{background:#4f46e50a}.text-muted[_ngcontent-%COMP%]{color:#6b7280}.state-loading[_ngcontent-%COMP%]{display:flex;justify-content:center;padding:48px;color:#9ca3af}.state-loading[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:28px}.state-error[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px 16px;background:#ef44440f;border:1px solid rgba(239,68,68,.2);border-radius:8px;color:#ef4444;margin-bottom:24px;font-size:.8125rem}.state-error[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:18px;flex-shrink:0}.empty-state[_ngcontent-%COMP%]{text-align:center;padding:48px;color:#9ca3af}.empty-state[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:40px;display:block;margin-bottom:12px}.empty-state[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{font-size:.875rem}.pagination[_ngcontent-%COMP%]{display:flex;align-items:center;justify-content:center;gap:12px;margin-top:24px}.pagination__info[_ngcontent-%COMP%]{font-size:.8125rem;color:#6b7280;min-width:60px;text-align:center}.tabs[_ngcontent-%COMP%]{display:flex;gap:2px;margin-bottom:24px;background:#f3f4f6;padding:3px;border-radius:8px;width:fit-content}.tab-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;padding:6px 12px;border:none;border-radius:6px;background:transparent;color:#6b7280;font-family:Manrope,-apple-system,BlinkMacSystemFont,sans-serif;font-size:.8125rem;font-weight:500;cursor:pointer;transition:all .15s ease}.tab-btn[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:16px}.tab-btn[_ngcontent-%COMP%]:hover{background:#fff;color:#111827}.tab-btn--active[_ngcontent-%COMP%]{background:#fff;color:#4f46e5;font-weight:600;box-shadow:0 1px 2px #0000000d}.card[_ngcontent-%COMP%]{background:#fff;border:1px solid #E5E7EB;border-radius:12px;padding:24px;display:flex;flex-direction:column;gap:12px;margin-bottom:24px}.card-title[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;font-size:.875rem;font-weight:600;color:#111827;margin:0}.card-title[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:18px;color:#6b7280}.form-grid[_ngcontent-%COMP%]{display:grid;grid-template-columns:repeat(auto-fill,minmax(220px,1fr));gap:12px}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:5px}.form-label[_ngcontent-%COMP%]{font-size:.8125rem;font-weight:500;color:#6b7280}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px}.form-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding-top:4px}.save-success[_ngcontent-%COMP%]{display:inline-flex;align-items:center;gap:4px;color:#22c55e;font-size:.8125rem;font-weight:500}.save-success[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:16px}.save-error[_ngcontent-%COMP%]{color:#ef4444;font-size:.8125rem}.icon-btn[_ngcontent-%COMP%]{display:inline-flex;align-items:center;justify-content:center;width:30px;height:30px;border:none;background:none;cursor:pointer;border-radius:4px;color:#6b7280;transition:background .15s ease,color .15s ease;flex-shrink:0}.icon-btn[_ngcontent-%COMP%]   .material-symbols-rounded[_ngcontent-%COMP%]{font-size:18px}.icon-btn[_ngcontent-%COMP%]:hover{background:#f3f4f6;color:#111827}.icon-btn--danger[_ngcontent-%COMP%]:hover{background:#ef444414;color:#ef4444}.actions-cell[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;white-space:nowrap}.link[_ngcontent-%COMP%]{color:#4f46e5;text-decoration:none;font-weight:500}.link[_ngcontent-%COMP%]:hover{color:#4338ca;text-decoration:underline}.section[_ngcontent-%COMP%]{margin-bottom:32px}.section-title[_ngcontent-%COMP%]{font-size:.875rem;font-weight:600;color:#111827;margin:0 0 12px}.fw-semibold[_ngcontent-%COMP%]{font-weight:600}.status-select[_ngcontent-%COMP%]{background:#f8f9fb;border:1px solid #E5E7EB;border-radius:4px;color:#111827;font-size:.6875rem;font-family:Manrope,-apple-system,BlinkMacSystemFont,sans-serif;padding:3px 8px;cursor:pointer;outline:none;transition:border-color .15s ease}.status-select[_ngcontent-%COMP%]:hover{border-color:#d1d5db}.status-select[_ngcontent-%COMP%]:focus{border-color:#4f46e5;box-shadow:0 0 0 2px #4f46e514}.order-lot[_ngcontent-%COMP%]{font-size:.8125rem;font-weight:600;color:#111827;white-space:nowrap}.buyer-name[_ngcontent-%COMP%]{font-size:.8125rem;font-weight:500;color:#111827;white-space:nowrap}.buyer-email[_ngcontent-%COMP%]{font-size:.6875rem;color:#9ca3af;white-space:nowrap;overflow:hidden;text-overflow:ellipsis;max-width:180px}.order-amount[_ngcontent-%COMP%]{font-family:Space Mono,JetBrains Mono,monospace;font-size:.8125rem;font-weight:600;color:#111827;white-space:nowrap}.order-id[_ngcontent-%COMP%]{font-family:Space Mono,JetBrains Mono,monospace;font-size:.6875rem;color:#9ca3af}"]})};export{J as OrdersPage};
