import{a as q}from"./chunk-NGKCTFB6.js";import"./chunk-3AM2QGJF.js";import{a as R}from"./chunk-P4DUZWIT.js";import{a as k,b as I,c as V,f as W,i as F,j as z,k as N,p as j}from"./chunk-NMP7FLI7.js";import"./chunk-PQRFCLHD.js";import{j as D}from"./chunk-Q2EY3VGC.js";import{$ as g,$a as C,Cb as O,Db as B,Ma as P,V as y,Ya as s,Za as p,_ as m,ab as S,bb as h,cb as o,db as t,eb as M,fb as b,ib as v,jb as c,ob as w,qb as a,rb as E,tb as L,ub as T,vb as A,wa as r,wb as _,xb as f,yb as x}from"./chunk-PMJPP6QG.js";var H=(i,n)=>n.id,J=(i,n)=>n.value;function K(i,n){i&1&&(o(0,"div",7)(1,"span",13),a(2,"progress_activity"),t()())}function Q(i,n){if(i&1){let e=b();o(0,"button",14),v("click",function(){let l=m(e).$implicit,d=c();return g(d.selectLot(l))}),o(1,"div",15),a(2),t(),o(3,"div",16),a(4),O(5,"number"),t()()}if(i&2){let e=n.$implicit,u=c();w("lot-item--selected",(u.selectedLot==null?null:u.selectedLot.id)===e.id),r(2),T("",e.brand," ",e.model," ",e.year),r(2),L("",e.status," \xB7 \u20AC",B(5,7,e.startingBid))}}function U(i,n){i&1&&(o(0,"p",10),a(1,"\u041D\u0435\u0442 \u043B\u043E\u0442\u043E\u0432 \u0432 \u0441\u0442\u0430\u0442\u0443\u0441\u0435 IMPORTED / ACTIVE"),t())}function X(i,n){i&1&&(o(0,"p",12),a(1,"\u0421\u043D\u0430\u0447\u0430\u043B\u0430 \u0432\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043B\u043E\u0442 \u0441\u043B\u0435\u0432\u0430"),t())}function Y(i,n){if(i&1&&(o(0,"option",22),a(1),t()),i&2){let e=n.$implicit;h("value",e.value),r(),E(e.label)}}function Z(i,n){if(i&1&&M(0,"app-bot-settings",28),i&2){let e=c(2);h("lotId",e.selectedLot.id)}}function $(i,n){i&1&&(o(0,"span",13),a(1,"progress_activity"),t())}function ee(i,n){i&1&&(o(0,"span",31)(1,"span",18),a(2,"check_circle"),t(),a(3," \u0421\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u043E "),t())}function te(i,n){if(i&1&&(o(0,"span",32),a(1),t()),i&2){let e=c(2);r(),E(e.saveError)}}function ie(i,n){if(i&1){let e=b();o(0,"div",17)(1,"span",18),a(2,"directions_car"),t(),a(3),t(),o(4,"div",19)(5,"label",20),a(6,"\u0422\u0438\u043F \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u0430"),t(),o(7,"select",21),x("ngModelChange",function(l){m(e);let d=c();return f(d.auctionType,l)||(d.auctionType=l),g(l)}),C(8,Y,2,2,"option",22,J),t()(),o(10,"div",23)(11,"div",19)(12,"label",20),a(13,"\u041D\u0430\u0447\u0430\u043B\u043E"),t(),o(14,"input",24),x("ngModelChange",function(l){m(e);let d=c();return f(d.auctionStartAt,l)||(d.auctionStartAt=l),g(l)}),t()(),o(15,"div",19)(16,"label",20),a(17,"\u041A\u043E\u043D\u0435\u0446"),t(),o(18,"input",24),x("ngModelChange",function(l){m(e);let d=c();return f(d.auctionEndAt,l)||(d.auctionEndAt=l),g(l)}),t()()(),o(19,"div",25)(20,"label",26)(21,"input",27),x("ngModelChange",function(l){m(e);let d=c();return f(d.enableBot,l)||(d.enableBot=l),g(l)}),t(),a(22," \u041F\u043E\u0434\u043A\u043B\u044E\u0447\u0438\u0442\u044C \u0442\u043E\u0440\u0433\u043E\u0432\u043E\u0433\u043E \u0431\u043E\u0442\u0430 "),t()(),s(23,Z,1,1,"app-bot-settings",28),o(24,"div",29)(25,"button",30),v("click",function(){m(e);let l=c();return g(l.save())}),s(26,$,2,0,"span",13),o(27,"span",18),a(28,"save"),t(),a(29," \u0421\u043E\u0445\u0440\u0430\u043D\u0438\u0442\u044C \u0440\u0430\u0441\u043F\u0438\u0441\u0430\u043D\u0438\u0435 "),t(),s(30,ee,4,0,"span",31),s(31,te,2,1,"span",32),t()}if(i&2){let e=c();r(3),A(" ",e.selectedLot.brand," ",e.selectedLot.model," ",e.selectedLot.year," \u2014 ",e.selectedLot.title," "),r(4),_("ngModel",e.auctionType),r(),S(e.auctionTypes),r(6),_("ngModel",e.auctionStartAt),r(4),_("ngModel",e.auctionEndAt),r(3),_("ngModel",e.enableBot),r(2),p(e.enableBot&&e.selectedLot?23:-1),r(2),h("disabled",e.saving||!e.auctionStartAt||!e.auctionEndAt),r(),p(e.saving?26:-1),r(4),p(e.saved?30:-1),r(),p(e.saveError?31:-1)}}var G=class i{lotService=y(R);lots=[];lotsLoading=!1;lotSearch="";selectedLot=null;auctionStartAt="";auctionEndAt="";auctionType="timed";enableBot=!1;saving=!1;saved=!1;saveError="";auctionTypes=[{value:"timed",label:"\u0422\u0435\u043D\u0434\u0435\u0440 (\u043F\u043E \u0432\u0440\u0435\u043C\u0435\u043D\u0438)"},{value:"buy_now",label:"\u041A\u0443\u043F\u0438\u0442\u044C \u0441\u0435\u0439\u0447\u0430\u0441"},{value:"both",label:"\u0422\u0435\u043D\u0434\u0435\u0440 + \u041A\u0443\u043F\u0438\u0442\u044C \u0441\u0435\u0439\u0447\u0430\u0441"}];ngOnInit(){this.loadLots()}loadLots(){this.lotsLoading=!0,this.lotService.getLots({limit:100,search:this.lotSearch||void 0}).subscribe({next:n=>{this.lots=n.data.filter(e=>["imported","active"].includes(e.status)),this.lotsLoading=!1},error:()=>this.lotsLoading=!1})}selectLot(n){this.selectedLot=n,n.auctionStart&&(this.auctionStartAt=n.auctionStart.slice(0,16)),n.auctionEnd&&(this.auctionEndAt=n.auctionEnd.slice(0,16))}save(){!this.selectedLot||!this.auctionStartAt||!this.auctionEndAt||(this.saving=!0,this.saved=!1,this.saveError="",this.lotService.scheduleLot(this.selectedLot.id,{auctionStartAt:new Date(this.auctionStartAt).toISOString(),auctionEndAt:new Date(this.auctionEndAt).toISOString(),auctionType:this.auctionType}).subscribe({next:n=>{this.selectedLot=n,this.saving=!1,this.saved=!0,setTimeout(()=>this.saved=!1,3e3)},error:n=>{this.saveError=n?.error?.message??"\u041E\u0448\u0438\u0431\u043A\u0430 \u0441\u043E\u0445\u0440\u0430\u043D\u0435\u043D\u0438\u044F",this.saving=!1}}))}static \u0275fac=function(e){return new(e||i)};static \u0275cmp=P({type:i,selectors:[["app-schedule"]],decls:19,vars:4,consts:[[1,"page"],[1,"page-header"],[1,"page-title"],[1,"schedule-layout"],[1,"card","lot-picker"],[1,"card-title"],["type","text","placeholder","\u041F\u043E\u0438\u0441\u043A \u043B\u043E\u0442\u0430...",1,"form-control",3,"ngModelChange","input","ngModel"],[1,"state-loading",2,"padding","20px 0"],[1,"lot-list"],[1,"lot-item",3,"lot-item--selected"],[1,"text-muted",2,"padding","12px 0"],[1,"card","schedule-form"],[1,"text-muted"],[1,"material-symbols-rounded","spin"],[1,"lot-item",3,"click"],[1,"lot-item__title"],[1,"lot-item__meta","text-muted"],[1,"selected-lot-banner"],[1,"material-symbols-rounded"],[1,"form-group"],[1,"form-label"],[1,"form-control",3,"ngModelChange","ngModel"],[3,"value"],[1,"form-row"],["type","datetime-local",1,"form-control",3,"ngModelChange","ngModel"],[1,"bot-toggle"],[1,"checkbox-label"],["type","checkbox",3,"ngModelChange","ngModel"],[3,"lotId"],[1,"form-actions"],[1,"btn","btn--primary",3,"click","disabled"],[1,"save-success"],[1,"save-error"]],template:function(e,u){e&1&&(o(0,"div",0)(1,"div",1)(2,"h1",2),a(3,"\u041F\u043B\u0430\u043D\u0438\u0440\u043E\u0432\u0430\u043D\u0438\u0435 \u0430\u0443\u043A\u0446\u0438\u043E\u043D\u043E\u0432"),t()(),o(4,"div",3)(5,"div",4)(6,"h2",5),a(7,"1. \u0412\u044B\u0431\u0435\u0440\u0438\u0442\u0435 \u043B\u043E\u0442"),t(),o(8,"input",6),x("ngModelChange",function(d){return f(u.lotSearch,d)||(u.lotSearch=d),d}),v("input",function(){return u.loadLots()}),t(),s(9,K,3,0,"div",7),o(10,"div",8),C(11,Q,6,9,"button",9,H),s(13,U,2,0,"p",10),t()(),o(14,"div",11)(15,"h2",5),a(16,"2. \u0420\u0430\u0441\u043F\u0438\u0441\u0430\u043D\u0438\u0435"),t(),s(17,X,2,0,"p",12)(18,ie,32,13),t()()()),e&2&&(r(8),_("ngModel",u.lotSearch),r(),p(u.lotsLoading?9:-1),r(2),S(u.lots),r(2),p(!u.lotsLoading&&u.lots.length===0?13:-1),r(4),p(u.selectedLot?18:17))},dependencies:[j,z,N,I,k,F,V,W,q,D],styles:[".schedule-layout[_ngcontent-%COMP%]{display:grid;grid-template-columns:340px 1fr;gap:20px;align-items:start}@media (max-width: 800px){.schedule-layout[_ngcontent-%COMP%]{grid-template-columns:1fr}}.card[_ngcontent-%COMP%]{background:var(--surface);border:1px solid var(--border);border-radius:var(--radius-lg);padding:24px;display:flex;flex-direction:column;gap:14px}.card-title[_ngcontent-%COMP%]{font-size:var(--fs-base);font-weight:600;margin:0}.lot-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:4px;max-height:480px;overflow-y:auto}.lot-item[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:2px;padding:10px 12px;border:1px solid var(--border);border-radius:var(--radius);background:none;text-align:left;cursor:pointer;transition:background .15s,border-color .15s}.lot-item[_ngcontent-%COMP%]:hover{background:var(--surface-hover)}.lot-item--selected[_ngcontent-%COMP%]{border-color:var(--accent);background:rgba(var(--accent-rgb, 99, 102, 241),.08)}.lot-item__title[_ngcontent-%COMP%]{font-weight:500;font-size:var(--fs-sm)}.lot-item__meta[_ngcontent-%COMP%]{font-size:var(--fs-xs)}.selected-lot-banner[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;padding:12px;background:var(--surface-hover);border-radius:var(--radius);font-size:var(--fs-sm);font-weight:500}.form-group[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px}.form-label[_ngcontent-%COMP%]{font-size:var(--fs-sm);color:var(--text-secondary);font-weight:500}.form-row[_ngcontent-%COMP%]{display:grid;grid-template-columns:1fr 1fr;gap:12px}.bot-toggle[_ngcontent-%COMP%]{padding:12px;border:1px dashed var(--border);border-radius:var(--radius)}.checkbox-label[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;font-size:var(--fs-sm);cursor:pointer;font-weight:500}.form-actions[_ngcontent-%COMP%]{display:flex;align-items:center;gap:12px;margin-top:8px}.save-success[_ngcontent-%COMP%]{display:flex;align-items:center;gap:4px;color:var(--green);font-size:var(--fs-sm)}.save-error[_ngcontent-%COMP%]{color:var(--red);font-size:var(--fs-sm)}"]})};export{G as SchedulePage};
